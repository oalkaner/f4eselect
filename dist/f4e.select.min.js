"use strict";!function(u,t,e){var s={multiple:!0,searchNoItem:"No item found",seperator:", ",displayToolbar:!0,searchType:"contains",disableSort:!1},i={searchBox:Handlebars.compile("<div class='searchbox-container'><input type='text' class='searchbox'><div style='position:absolute;right:22px;top:13px'><i class='fa fa-search' style='margin-right:-10px'/></div></div>"),newOption:Handlebars.compile("{{#if newOptionEnabled}}<div class='addnew'><a class='f4-add-new-button'>{{newOptionText}}</a></div>{{/if}}{{#if descriptionEnabled}}<div class='addnewdescription'>{{description}}</div>{{/if}}"),toolbar:Handlebars.compile("<div class='f4e-toolbar'>{{#if multiple}}<i class='f4e-toolbarbutton fa fa-fw fa-check'/><i class='f4e-toolbarbutton fa fa-fw fa-remove'/>{{/if}}{{#if disableSort}}<div></div>{{else}}<i class='f4e-toolbarbutton fa fa-fw fa-sort'/>{{/if}}</div>"),menuItems:Handlebars.compile("<div class='f4e-menu-items'style='max-height:{{menuItemsMaxHeight}}vh;overflow:auto'>{{#if nooptions}}<div class='no-search'>{{noSearchFoundText}}</div>{{else}}{{#each options}}{{#if isDataDividerEnabled}}<hr/>{{else}}{{#if isDisabled}}<div class='f4e-menu-item' disabled style='line-height:4vh' value='{{val}}'>{{else}}<div class='f4e-menu-item' style='line-height:4vh' value='{{val}}'>{{/if}}{{#if isfaClassEnabled}}<i class='{{faClass}}' style='margin-right:5px'/>{{/if}}{{#if isDataContentEnabled}}{{{dataContent}}}{{else}}<span>{{optionText}}</span>{{/if}}{{#if isDataSubtextEnabled}}<small class='f4e-subtext'>{{dataSubtext}}</small>{{/if}}{{#if isChecked}}<i class='fa fa-check' style='margin-left:5px'/>{{/if}}</div>{{/if}}{{/each}}{{/if}}</div>")};function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function l(t,e){this.$selectElement=u(t),e.size=this.$selectElement.attr("data-size"),e.seperator=this.$selectElement.attr("data-seperator"),e.displayToolbar=!this.$selectElement[0].hasAttribute("data-disabletoolbar"),e.searchNoItem=this.$selectElement.attr("data-searchNoItem"),e.multiple=this.$selectElement[0].hasAttribute("data-multiple"),e.searchType=this.$selectElement.attr("data-searchtype"),e.disableSort=this.$selectElement[0].hasAttribute("data-disablesort"),this.settings=u.extend({},s,e),this.selectedItems=[],this.$dropDown=null,this.sortedBy="",this.init()}l.prototype={init:function(){var t=this.$selectElement.attr("data-selecttext");this.$dropDown=u("<div class='f4e-dropdown'><a class='f4e-button'>"+t+"</a></div>"),this.$selectElement.after(this.$dropDown),this.$selectElement.css("display","none"),this.bindEvents()},bindEvents:function(){var s=this;u(t).on("click",function(t){s.destroyMenu()}),this.$dropDown.on("click",function(t){t.stopPropagation()}),this.$dropDown.on("click",".f4e-button",function(t){s.clickOpenMenuCallback(t)}),this.$dropDown.on("click",".f4e-menu-item",function(t){var e={val:u(this).attr("value"),text:u(this).text()};s.clickMenuItemCallback(t,e)}),this.$dropDown.on("keyup",".searchbox",function(t){var e=u(this).val();s.typeSearchBoxCallback(t,e)}),this.$dropDown.on("click",".f4-add-new-button",function(t){s.clickAddNewOptionCallback(t)}),this.$dropDown.on("click",".fa-check",function(t){s.selectAllItemsCallback(t)}),this.$dropDown.on("click",".fa-remove",function(t){s.clickDeselectAllCallback(t)}),this.$dropDown.on("click",".fa-sort",function(t){s.clickSortAllCallback(t)})},clickDeselectAllCallback:function(){0!=this.selectedItems.length&&(this.selectedItems=[],this.$selectElement.find("option").removeAttr("selected"),null!=this.settings.ondeselectall&&this.settings.ondeselectall(),this.setButtonText(),this.$dropDown.find(".f4e-menu-item .fa-check").remove())},clickAddNewOptionCallback:function(t){var e=this.$dropDown.find(".searchbox").val();if(""!=e){var s=(n()+n()+"-"+n()+"-4"+n().substr(0,3)+"-"+n()+"-"+n()+n()+n()).toLowerCase();if(null!=this.settings.onitemadd){var i=this.settings.onitemadd(e);null!=i&&(s=i)}this.$selectElement.prepend("<option value='"+s+"'>"+e+"</option>"),this.selectItem({val:s,text:e}),this.$dropDown.find(".f4e-menu-items").remove(),this.$dropDown.find(".searchbox-container").after(u(this.renderMenuItems()))}},typeSearchBoxCallback:function(t,e){this.$dropDown.find(".f4e-menu-items").remove(),this.$dropDown.find(".searchbox-container").after(u(this.renderMenuItems(e)))},clickMenuItemCallback:function(t,e){this.selectItem(e)},clickOpenMenuCallback:function(t){0==this.$dropDown.find(".f4e-menu-items").length?this.displayMenu():this.destroyMenu()},selectAllItemsCallback:function(t){var e=this.$selectElement.find("option:not([disabled])"),s=this.settings.maxOptions;return null==s||s>=e.length?(this.selectedItems=u.map(e,function(t,e){return{val:u(t).attr("value"),text:u(t).text()}}),this.$selectElement.find("option:not([disabled])").attr("selected",!0),null!=this.settings.onselectall&&this.settings.onselectall(),this.setButtonText(),this.$dropDown.find(".f4e-menu-item .fa-check").remove(),this.$dropDown.find(".f4e-menu-item").append("<i class='fa fa-check' style='margin-left:5px'/>"),e.length):0},clickSortAllCallback:function(){""==this.sortedBy||"desc"==this.sortedBy?(this.$selectElement.find("option").sort(function(t,e){return u(t).text()>u(e).text()}).appendTo(this.$selectElement),this.sortedBy="asc"):(this.$selectElement.find("option").sort(function(t,e){return u(t).text()<u(e).text()}).appendTo(this.$selectElement),this.sortedBy="desc"),this.$dropDown.find(".f4e-menu-items").remove(),this.$dropDown.find(".searchbox-container").after(u(this.renderMenuItems()))},renderMenu:function(){var t="<div class='f4e-menu'>";return t+="<div>",t+=this.renderSearchBox(),t+=this.renderMenuItems(),t+=this.renderNewOption(),t+="</div>",this.settings.displayToolbar&&(t+=this.renderToolbar()),t+="</div>"},renderToolbar:function(){var t={multiple:this.settings.multiple,disableSort:this.settings.disableSort};return i.toolbar(t)},renderNewOption:function(){var t={newOptionEnabled:null!=this.$selectElement.attr("data-newoption"),newOptionText:this.$selectElement.attr("data-newoption"),descriptionEnabled:null!=this.$selectElement.attr("data-description"),description:this.$selectElement.attr("data-description")};return i.newOption(t)},renderSearchBox:function(){return i.searchBox({})},renderMenuItems:function(c){var d=this,t=this.settings.size,e=this.$selectElement.find("option"),h={menuItemsMaxHeight:18,menuItemLineHeight:4,options:[],searchText:c};return null!=t&&(h.menuItemsMaxHeight=6*t),e.each(function(t){var e=u(this).attr("value"),s=u(this).text(),i=u(this).attr("class"),n=u(this).attr("disabled"),l=u(this).attr("data-content"),a=u(this).attr("data-subtext"),o=u(this).attr("data-divider");if(null!=c){var r=s.toLowerCase().indexOf(c.toLowerCase());if("contains"==d.settings.searchType&&-1==r)return!0;if("starts"==d.settings.searchType&&0!=r)return!0}h.options.push({val:e,optionText:s,isfaClassEnabled:null!=i,faClass:i,isDisabled:null!=n,isDataContentEnabled:null!=l,dataContent:l,isDataSubtextEnabled:null!=a,dataSubtext:a,isDataDividerEnabled:null!=o,isChecked:-1!=d.selectedItems.findIndex(function(t){return t.val==e}),noSearchFoundText:d.settings.searchNoItem})}),h.nooptions=0==h.options.length&&null!=c,i.menuItems(h)},setButtonText:function(){var s=this,i="";0<this.selectedItems.length?this.selectedItems.forEach(function(t,e){i+=t.text,e!=s.selectedItems.length-1&&(i+=s.settings.seperator)}):i=this.$selectElement.attr("data-selecttext"),this.$dropDown.find(".f4e-button").text(i)},displayMenu:function(){var t=u(this.renderMenu());this.$dropDown.find(".f4e-button").next().remove(),this.$dropDown.find(".f4e-button").after(t),null!=this.settings.onopen&&this.settings.onopen()},destroyMenu:function(){this.$dropDown.find(".f4e-menu").remove(),null!=this.settings.onclose&&this.settings.onclose()},selectItem:function(e){var t=this.selectedItems.findIndex(function(t){return t.val==e.val});if(!this.$dropDown.find('.f4e-menu-item[value="'+e.val+'"]').hasClass("disabled"))if(-1==t){if(this.settings.multiple){var s=this.settings.maxOptions;if(null==s)this.selectedItems.push(e);else{if(!(null!=s&&this.selectedItems.length+1<=s))return;this.selectedItems.push(e)}this.$dropDown.find('.f4e-menu-item[value="'+e.val+'"]').append("<i class='fa fa-check' style='margin-left:5px'/>")}else this.selectedItems=[e],this.destroyMenu();null!=this.settings.onselect&&this.settings.onselect(e),this.$selectElement.find('option[value="'+e.val+'"]').attr("selected",!0),this.setButtonText()}else this.selectedItems.splice(t,1),null!=this.settings.ondeselect&&this.settings.ondeselect(e),this.$selectElement.find('option[value="'+e.val+'"]').removeAttr("selected"),this.setButtonText(),this.settings.multiple?this.$dropDown.find('.f4e-menu-item[value="'+e.val+'"] .fa-check').remove():this.destroyMenu()}},u.fn.f4eselect=function(t){return this.each(function(){u.data(this,"f4eselect")||u.data(this,"f4eselect",new l(this,t))})}}(jQuery,window,document);